# Security Analysis: Secret Network

**Last Updated**: 2026-01-28

---

## Executive Summary

Secret Network implements a hardware-based privacy model using Intel SGX Trusted Execution Environments (TEE). While this enables powerful privacy guarantees for smart contract execution, it introduces a hardware trust dependency that has been challenged by academic researchers. The team has demonstrated active incident response, implementing significant mitigations in v1.22 and v1.23 upgrades.

---

## Privacy Model

### Core Approach

Secret Network uses Trusted Execution Environments (Intel SGX) to provide encrypted smart contract execution. Node operators cannot see:
- Transaction inputs (function parameters)
- Contract internal state
- Transaction outputs (return values)

```
User Input → Encrypt → Validator SGX Enclave → Decrypt & Execute → Encrypt Output → User
                            │
                     State encrypted at rest
```

### What Remains Public

- Contract code (WASM binary) - auditable
- Transaction sender/receiver addresses
- Gas fees
- Block metadata
- Transaction graph (who interacts with whom)

---

## Trusted Execution Environment (TEE)

### Intel SGX Overview

Intel Software Guard Extensions (SGX) creates isolated "enclaves" within the CPU:

| Property | Description |
|----------|-------------|
| Memory Isolation | Enclave memory encrypted by hardware |
| OS Isolation | Operating system cannot access enclave data |
| Attestation | Remote proof that genuine SGX is running |

### Secret Network's SGX Implementation

Every Secret Network validator:
1. Runs SGX-enabled hardware (Intel CPUs with SGX support)
2. Passes remote attestation to prove genuine enclave
3. Receives encrypted consensus seed after attestation
4. Executes contract code inside secure enclaves
5. Decrypts user inputs only within the enclave
6. Encrypts outputs before returning to users

---

## Cryptographic Design

### Encryption Stack

| Component | Algorithm | Standard | Purpose |
|-----------|-----------|----------|---------|
| State Encryption | AES-128-SIV | RFC 5297 | Nonce-misuse resistant encryption |
| Key Derivation | HKDF-SHA256 | RFC 5869 | Derive keys from consensus seed |
| Key Exchange | ECDH | ANSI X9.63 | User-enclave key agreement |
| Signatures | Ed25519 | RFC 8032 | Enclave signatures |
| Hashing | SHA-256 | FIPS 180-4 | General hashing |

### Why AES-SIV?

The team chose AES-SIV over AES-GCM because:
- **Nonce-misuse resistant**: SGX environments have constrained random number generation
- **Graceful degradation**: Nonce reuse only reveals if two plaintexts are identical
- **AES-GCM risk**: Nonce reuse in GCM mode catastrophically reveals XOR of plaintexts

### Consensus Seed

The consensus seed is the master key for the entire network:
1. Generated by the first bootstrap node inside SGX
2. Distributed to new validators via encrypted channels
3. All encryption keys derived from this seed
4. Sealed to disk using SGX sealing

---

## Security Design Assumptions

From the Secret Network graypaper:

1. **Untrusted Hosts**: Each node is assumed to be run by a malicious host
2. **Trusted Enclaves**: SGX enclaves execute code securely
3. **Cryptographic Guarantees**: Standard cryptographic assumptions hold
4. **Intel Trust**: Intel SGX hardware is not compromised

---

## Known Vulnerabilities & Incidents

### xAPIC / AEPIC Leak (August 2022)

**Severity**: Critical
**CVE**: CVE-2022-21233

| Aspect | Details |
|--------|---------|
| Discovery | Publicly disclosed August 9, 2022 |
| Impact | Could extract consensus seed from vulnerable Intel CPUs |
| Requires | Physical access to server hardware |
| Affected | 3rd Generation Intel Scalable CPUs |

**Attack Description**:
- Vulnerability in certain Intel SGX chips allowed uninitialized memory reads
- Researchers demonstrated extraction of consensus seed
- Consensus seed = master decryption key for all private transactions

**Quote** (Andrew Miller, Lead Researcher): "We evaluated TEE-based blockchain Secret Network to see if it was susceptible to AEPICLeak, and ended up finding the master decryption key for the whole network."

**Response**:
- White-hat researchers contacted team October 3, 2022
- Immediate mitigation measures implemented
- v1.22 upgrade deployed with comprehensive fixes

---

### Wiretap.fail Attack (2024)

**Severity**: High

| Aspect | Details |
|--------|---------|
| Discovery | Academic researchers (wiretap.fail) |
| Impact | Attestation forgery possible with physical access |
| Requires | Physical access to 3rd Gen Intel Scalable CPUs |
| Affected Projects | Secret Network, Phala, Crust Network, IntegriTee |

**Response** (v1.22 Upgrade):
1. **Network Access Control**: Suspended new node registration
2. **Trusted Allowlist**: Curated list of verified validators
3. **Seed Rotation**: Changed consensus seed

**Important Note**: According to researchers, "Secret Network is the only project that implemented such proactive measures."

---

### TEE.fail / DDR5 Vulnerability (2024)

**Severity**: High (initially), Assessed as Not Exploitable

| Aspect | Details |
|--------|---------|
| Discovery | Extension of wiretap.fail to 4th+ Gen Intel CPUs |
| Target | DDR5 memory systems |
| Impact Assessment | Different memory architecture than Secret Network nodes |

**SCRT Labs Response**: "No action is required from users or node operators of Secret Network. Neither data nor funds are at risk. This attack is essentially an extension of wiretap.fail attack to additional processor models."

---

### API Server Vulnerabilities (Discovered 2026-01-20)

**Severity**: Critical (Infrastructure)

| Component | Issue |
|-----------|-------|
| Server | api.scrt.network (85.17.52.219) |
| Nginx Version | 1.16.1 (End of Life) |
| CVEs Detected | 5 |

**CVE List**:
- CVE-2023-44487 (HTTP/2 Rapid Reset)
- CVE-2025-23419
- CVE-2021-23017
- CVE-2021-3618
- CVE-2019-20372

**Note**: These are infrastructure vulnerabilities, not core protocol issues. The main website (scrt.network) is clean.

---

## Security Upgrades Timeline

### v1.22 (September 2025) - Critical Security Upgrade

| Mitigation | Description |
|------------|-------------|
| Network Access Control | Suspended acceptance of new nodes |
| Trusted Node Allowlist | Curated list of known, verified validators |
| Seed Rotation | Changed consensus seed to invalidate any leaked keys |
| Permissioned Mode | Fully permissioned operation |

### v1.23 (October 2025) - Semi-Permissioned Mode

| Change | Description |
|--------|-------------|
| Governance Approval | New validators can be added through governance vote |
| Azure Allowlist | Microsoft Azure nodes can join without limitation |
| Relaxed Restrictions | Semi-permissioned vs fully permissioned |

### MRENCLAVE Upgrades (H1 2025)

Two critical MRENCLAVE upgrades completed:
- Required deep cryptographic expertise
- Careful coordination to maintain network stability
- Enhanced security while preserving functionality

---

## Trust Model

### Users Must Trust

1. **Intel SGX Hardware**: Hardware root of trust
2. **SGX Implementation**: Intel's implementation is secure
3. **Attestation Process**: Verification catches compromised nodes
4. **Validator Set**: Operators run genuine enclaves

### Mitigating Factors

1. **Distributed Validators**: No single point of failure
2. **On-chain Attestation**: Public verification of enclave authenticity
3. **Open Source Code**: Enclave code publicly auditable
4. **Active Response**: Team responds quickly to disclosures

### Key Design Decision

**"Funds were never at risk, because Secret intentionally does not rely on SGX for correctness - only privacy."** - Guy Zyskind

This means:
- SGX protects privacy (encrypted execution)
- Consensus protects correctness (Tendermint BFT)
- Compromised SGX leaks data but cannot steal funds

---

## Comparison to Other Privacy Approaches

| Approach | Trust Model | Computation | Tradeoffs |
|----------|-------------|-------------|-----------|
| **Secret Network (TEE)** | Hardware (Intel) | General purpose | Hardware dependency |
| **ZK Proofs** | Math only | Limited/expensive | Slow proof generation |
| **Mixnets** | Node operators | N/A | Network latency |
| **Ring Signatures** | Cryptographic | Transaction hiding | Limited to transfers |

---

## Security Features

### Encrypted Mempool
- Transactions encrypted before entering mempool
- Prevents frontrunning by default
- Order sizes, bids, liquidation points hidden

### Viewing Keys
- Users can create keys to share specific data
- Selective disclosure to auditors, regulators
- Privacy preserved for everyone else

### Callback Authentication
- Inter-contract messages cryptographically signed
- Receiving contracts verify sender identity
- Prevents message spoofing

---

## Security Audit Status

### Public Audit Reports

**Status**: No comprehensive public audit reports found for core protocol

**Note**:
- Individual dApps/contracts have been audited
- Core SGX enclave code audit reports not publicly available
- Bug bounty program exists (details not publicly specified)

### Security Contact

**Email**: info@scrtlabs.com

**Coordinated Disclosure Policy**:
- Allow reasonable time for patch development
- Do not exploit discovered vulnerabilities
- Do not disrupt network services
- Bug bounty payments available

---

## Infrastructure Security (OSINT)

| Component | Status |
|-----------|--------|
| Main Website (scrt.network) | CLEAN - Cloudflare protected |
| API Server (api.scrt.network) | CRITICAL - Outdated nginx, 5 CVEs |
| RPC Infrastructure | CLEAN - Fastly CDN |
| DNS Provider | Cloudflare |
| Security Headers | PARTIAL - Missing CSP, X-Frame-Options |

---

## Recommendations for Users

1. **Understand the Trust Model**: Privacy depends on Intel SGX security
2. **Monitor Upgrades**: Apply network upgrades promptly
3. **Use Viewing Keys Carefully**: Share only with trusted parties
4. **Diversify**: Don't store all assets on any single platform
5. **Transaction Privacy**: Addresses are still public

---

## Roadmap: SGX Decoupling (2026)

Major planned security improvement:
- Ability to run nodes without SGX hardware
- Reduces hardware dependency
- Improves network accessibility
- Maintains privacy guarantees through alternative means

---

## Conclusion

Secret Network's security model is sophisticated but carries inherent tradeoffs:

**Strengths**:
- Active security response team
- Thoughtful cryptographic design (AES-SIV)
- Funds protected by consensus (not just SGX)
- Only project to implement proactive wiretap.fail mitigations

**Concerns**:
- Hardware trust dependency on Intel
- Historical SGX vulnerabilities
- No public comprehensive protocol audit
- Infrastructure vulnerabilities (API server)

**Risk Assessment**: Medium-High for privacy guarantees, Low for fund security

---

## Sources

| Source | Type |
|--------|------|
| [Secret Network Graypaper](https://scrt.network/graypaper) | Technical |
| [SGX Documentation](https://docs.scrt.network/secret-network-documentation/introduction/secret-network-techstack/privacy-technology/intel-sgx) | Official |
| [Wiretap.fail Response](https://scrt.network/blog/secret-network-security-update-intel-sgx-vulnerability-response) | Official |
| [The Block - Vulnerability Response](https://www.theblock.co/post/190914/secret-network-says-it-resolved-risk-from-intel-hardware-vulnerability) | News |
| [Cointelegraph - White Hat Disclosure](https://cointelegraph.com/news/secret-network-resolves-network-vulnerability-following-white-hat-disclosure) | News |
| [SCRT Labs - TEE.fail Response](https://scrt.network/blog/secret-labs-response-to-tee-fail-ddr5-vulnerability) | Official |
| [SGX.fail](https://sgx.fail/) | Research |

---

*Security analysis based on public disclosures, documentation, and code review. Not a formal security audit.*
